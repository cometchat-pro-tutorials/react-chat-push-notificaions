{"ast":null,"code":"import firebase from 'firebase';\nconst config = {\n  apiKey: \"AIzaSyBhkVOSvn4M6kkNPlMI7U3g9pXPqMeCNmc\",\n  authDomain: \"push-notifications-testi-217e6.firebaseapp.com\",\n  databaseURL: \"https://push-notifications-testi-217e6.firebaseio.com\",\n  projectId: \"push-notifications-testi-217e6\",\n  storageBucket: \"\",\n  messagingSenderId: \"375949858529\",\n  appId: \"1:375949858529:web:2ecd8afc2259b04a\"\n};\nconst init = firebase.initializeApp(config);\nconst messaging = init.messaging();\nmessaging.requestPermission().then(() => {\n  console.log('Have Permission');\n  return messaging.getToken();\n}).then(token => {\n  console.log('FCM Token:', token);\n  var userType = 'group';\n  var UID = process.env.REACT_APP_COMETCHAT_GUID;\n  var appId = process.env.REACT_APP_COMETCHAT_APP_ID;\n  var topic = appId + '_' + userType + '_' + UID;\n  var url = 'https://ext-push-notifications.cometchat.com/fcmtokens/' + token + '/topics/' + topic;\n  fetch(url, {\n    method: 'POST',\n    headers: new Headers({\n      'Content-Type': 'application/json'\n    }),\n    body: JSON.stringify({\n      appId: appId\n    })\n  }).then(response => {\n    if (response.status < 200 || response.status >= 400) {\n      console.log('Error subscribing to topic: ' + response.status + ' - ' + response.text());\n    }\n\n    console.log('Subscribed to \"' + topic + '\"');\n  }).catch(error => {\n    console.error(error);\n  });\n}).catch(error => {\n  if (error.code === 'messaging/permission-blocked') {\n    console.log('Please Unblock Notification Request Manually');\n  } else {\n    console.log('Error Occurred', error);\n  }\n});\nmessaging.onMessage(function (payload) {\n  console.log('Receiving foreground message'); // Customize notification here\n\n  var notificationTitle = 'New CometChat message';\n  var notificationOptions = {\n    body: payload.data.alert,\n    icon: payload.data.entities.sender.entity.avatar\n  };\n  var notification = new Notification(notificationTitle, notificationOptions);\n\n  notification.onclick = function (event) {\n    notification.close(); //handle click event onClick on Web Push Notification\n  };\n});","map":{"version":3,"sources":["/Users/booker/Code/why-no-werk/src/firebase.js"],"names":["firebase","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","init","initializeApp","messaging","requestPermission","then","console","log","getToken","token","userType","UID","process","env","REACT_APP_COMETCHAT_GUID","REACT_APP_COMETCHAT_APP_ID","topic","url","fetch","method","headers","Headers","body","JSON","stringify","response","status","text","catch","error","code","onMessage","payload","notificationTitle","notificationOptions","data","alert","icon","entities","sender","entity","avatar","notification","Notification","onclick","event","close"],"mappings":"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","sourcesContent":["import firebase from 'firebase';\n\nconst config = {\n  apiKey: \"AIzaSyBhkVOSvn4M6kkNPlMI7U3g9pXPqMeCNmc\",\n  authDomain: \"push-notifications-testi-217e6.firebaseapp.com\",\n  databaseURL: \"https://push-notifications-testi-217e6.firebaseio.com\",\n  projectId: \"push-notifications-testi-217e6\",\n  storageBucket: \"\",\n  messagingSenderId: \"375949858529\",\n  appId: \"1:375949858529:web:2ecd8afc2259b04a\"\n};\n\nconst init = firebase.initializeApp(config);\n\nconst messaging = init.messaging();\nmessaging\n  .requestPermission()\n  .then(() => {\n    console.log('Have Permission');\n    return messaging.getToken();\n  })\n  .then(token => {\n    console.log('FCM Token:', token);\n    var userType = 'group';\n    var UID = process.env.REACT_APP_COMETCHAT_GUID;\n    var appId = process.env.REACT_APP_COMETCHAT_APP_ID;\n\n    var topic = appId + '_' + userType + '_' + UID;\n\n    var url =\n      'https://ext-push-notifications.cometchat.com/fcmtokens/' +\n      token +\n      '/topics/' +\n      topic;\n\n    fetch(url, {\n      method: 'POST',\n      headers: new Headers({\n        'Content-Type': 'application/json',\n      }),\n      body: JSON.stringify({appId: appId}),\n    })\n      .then(response => {\n        if (response.status < 200 || response.status >= 400) {\n          console.log(\n            'Error subscribing to topic: ' +\n              response.status +\n              ' - ' +\n              response.text()\n          );\n        }\n\n        console.log('Subscribed to \"' + topic + '\"');\n      })\n      .catch(error => {\n        console.error(error);\n      });\n  })\n  .catch(error => {\n    if (error.code === 'messaging/permission-blocked') {\n      console.log('Please Unblock Notification Request Manually');\n    } else {\n      console.log('Error Occurred', error);\n    }\n  });\n\nmessaging.onMessage(function(payload) {\n  console.log('Receiving foreground message');\n  // Customize notification here\n  var notificationTitle = 'New CometChat message';\n  var notificationOptions = {\n    body: payload.data.alert,\n    icon: payload.data.entities.sender.entity.avatar,\n  };\n\n  var notification = new Notification(\n    notificationTitle,\n    notificationOptions\n  );\n\n  notification.onclick = function(event) {\n    notification.close();\n    //handle click event onClick on Web Push Notification\n  };\n});"]},"metadata":{},"sourceType":"module"}